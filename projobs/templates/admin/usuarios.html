{# Hereda de la plantilla base de perfil para mantener consistencia de dise√±o #}
{% extends 'baseperfil.html' %}
{% load static %}

{# Bloque principal de contenido que se renderiza dentro de baseperfil.html #}
{% block content %}
<div class="admin-container">
  <h2>Gesti√≥n de Usuarios</h2>

  {# Muestra los mensajes del sistema, como confirmaciones o errores #}
  {% for message in messages %}
    <div class="msg">{{ message }}</div>
  {% endfor %}

  {# Tabla que lista los usuarios registrados en el sistema #}
  <table class="admin-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>Correo</th>
        <th>Rol</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      {# Iteraci√≥n sobre cada usuario pasado desde la vista #}
      {% for u in usuarios %}
        <tr>
          <td>{{ u.id }}</td> {# ID √∫nico del usuario #}
          <td>{{ u.nombre }} {{ u.apellido }}</td> {# Nombre completo del usuario #}
          <td>{{ u.correo }}</td> {# Correo electr√≥nico del usuario #}
          <td>{{ u.get_rol_display }}</td> {# Muestra el rol con su nombre legible #}
          <td>
            {# Formulario para eliminar el usuario #}
            <form method="post" style="display:inline;">
              {% csrf_token %}
              <input type="hidden" name="user_id" value="{{ u.id }}">
              <button type="submit" name="accion" value="eliminar" onclick="return confirm('¬øEliminar usuario?')">üóëÔ∏è</button>
            </form>

            {# Formulario para cambiar el rol del usuario, con selecci√≥n autom√°tica #}
            <form method="post" style="display:inline;">
              {% csrf_token %}
              <input type="hidden" name="user_id" value="{{ u.id }}">
              <select name="accion" onchange="this.form.submit()">
                <option disabled selected>üìÇ Cambiar Rol</option>
                <option value="rol_1">Admin</option>
                <option value="rol_2">Cliente</option>
                <option value="rol_3">Trabajador</option>
              </select>
            </form>
          </td>
        </tr>
      {% empty %}
        <tr><td colspan="5">No hay usuarios registrados.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}

{# Estilos espec√≠ficos para esta vista, aplicados en l√≠nea por conveniencia #}
<style>
.admin-container {
  max-width: 1000px;
  margin: 0 auto;
}
.admin-table {
  width: 100%;
  border-collapse: collapse;
}
.admin-table th, .admin-table td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: left;
}
.admin-table th {
  background: #f0f0f0;
}
</style>
