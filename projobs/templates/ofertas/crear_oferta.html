{% extends 'baseperfil.html' %}
{# Hereda de la plantilla base de perfil para mantener el dise√±o coherente #}

{% load static %}
{# Carga el sistema de archivos est√°ticos de Django para usar CSS/JS #}

{% block content %}
{# Inicio del bloque de contenido principal de la p√°gina #}

<h2 class="titulo-seccion">üü¢ Publicar oferta para contratar un profesional independiente</h2>
<p class="descripcion-seccion">Completa este formulario para ofrecer un trabajo a trabajadores independientes.</p>

{# Secci√≥n de mensajes flash (√©xito, error, etc.) #}
{% if messages %}
  <ul class="messages">
    {% for message in messages %}
      <li class="{{ message.tags }}">{{ message }}</li>
    {% endfor %}
  </ul>
{% endif %}

{# Formulario para publicar una nueva oferta laboral #}
<form method="POST" class="form-crear-oferta">
  {% csrf_token %} {# Protecci√≥n contra ataques CSRF #}

  {# Campo para el t√≠tulo de la oferta #}
  <label for="titulo">T√≠tulo:</label>
  <input type="text" name="titulo" required maxlength="100"
         placeholder="Ej: Necesito t√©cnico de lavadoras"
         pattern="^[a-zA-Z0-9√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ë.,()\- ]{5,100}$"
         title="Solo texto alfanum√©rico y puntuaci√≥n b√°sica.">

  {# Campo para descripci√≥n detallada del trabajo #}
  <label for="descripcion">Descripci√≥n del trabajo:</label>
  <textarea name="descripcion" rows="4" required maxlength="1000"
            placeholder="Describe lo que necesitas que se realice..."
            pattern="^[^<>]{10,1000}$"
            title="Evita usar caracteres HTML como < o >."></textarea>

  {# Campo para la ubicaci√≥n f√≠sica del trabajo #}
  <label for="ubicacion">Ubicaci√≥n:</label>
  <input type="text" name="ubicacion" required maxlength="100"
         placeholder="Ej: Medell√≠n, Laureles"
         pattern="^[a-zA-Z0-9√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ë.,()\- ]{3,100}$">

  {# Selector del tipo de modalidad de trabajo #}
  <label for="modo_trabajo">Modo de trabajo:</label>
  <select name="modo_trabajo" required>
    <option value="presencial">Presencial</option>
    <option value="remoto">Remoto</option>
    <option value="hibrido">H√≠brido</option>
  </select>

  {# Rango deslizante para indicar el valor estimado de la oferta #}
  <label for="rango_pago">Valor estimado de la oferta ($COP):</label>
  <input type="range" id="rango_pago" name="rango_pago" min="10000" max="100000000" step="10000" value="10000000"
         oninput="outputPago.value = '$' + parseInt(this.value).toLocaleString('es-CO')">
  <output id="outputPago" style="font-weight: bold;">$100.000</output>

  {# Fecha l√≠mite para recibir postulaciones (m√≠nimo la fecha actual) #}
  <label for="fecha_limite">Fecha l√≠mite para aplicar:</label>
  <input type="date" name="fecha_limite" required id="fecha_limite">

  {# Selector del tipo de servicio (categor√≠a del profesional) #}
  <label for="categoria">Tipo de servicio requerido:</label>
  <select name="categoria" required>
    <option value="">Selecciona una opci√≥n</option>
    {# Opciones de categor√≠as predeterminadas #}
    <option value="Administrador">Administrador</option>
    <option value="Abogado">Abogado</option>
    <option value="Agente Call Center">Agente Call Center</option>
    <option value="Analista de Sistemas">Analista de Sistemas</option>
    <option value="Arquitecto">Arquitecto</option>
    <option value="Auxiliar Contable">Auxiliar Contable</option>
    <option value="Barbero">Barbero</option>
    <option value="Bi√≥logo">Bi√≥logo</option>
    <option value="Carpintero">Carpintero</option>
    <option value="Chef">Chef</option>
    <option value="Conductor">Conductor</option>
    <option value="Contador P√∫blico">Contador P√∫blico</option>
    <option value="Dise√±ador Gr√°fico">Dise√±ador Gr√°fico</option>
    <option value="Electricista">Electricista</option>
    <option value="Enfermero">Enfermero</option>
    <option value="Estilista">Estilista</option>
    <option value="Ingeniero Civil">Ingeniero Civil</option>
    <option value="Ingeniero de Sistemas">Ingeniero de Sistemas</option>
    <option value="Jardinero">Jardinero</option>
    <option value="Mec√°nico">Mec√°nico</option>
    <option value="Mensajero">Mensajero</option>
    <option value="Panadero">Panadero</option>
    <option value="Paseador de Perros">Paseador de Perros</option>
    <option value="Pintor">Pintor</option>
    <option value="Plomero">Plomero</option>
    <option value="Programador">Programador</option>
    <option value="Psic√≥logo">Psic√≥logo</option>
    <option value="Publicista">Publicista</option>
    <option value="Soldador">Soldador</option>
    <option value="T√©cnico de Lavadoras">T√©cnico de Lavadoras</option>
    <option value="T√©cnico Electricista">T√©cnico Electricista</option>
    <option value="T√©cnico en Refrigeraci√≥n">T√©cnico en Refrigeraci√≥n</option>
    <option value="Veterinario">Veterinario</option>
    <option value="Vigilante">Vigilante</option>
    <option value="Otro">Otro</option>
  </select>

  {# Campo opcional para detallar profesi√≥n personalizada si se elige "Otro" #}
  <label for="descripcion_profesion">Describe la profesi√≥n si seleccionaste "Otro":</label>
  <input type="text" name="descripcion_profesion" placeholder="Ej: Paseador de perros"
         pattern="^[a-zA-Z0-9√°√©√≠√≥√∫√Å√â√ç√ì√ö√±√ë.,()\- ]{0,100}$">

  {# N√∫mero de trabajadores m√°ximos que se desea contratar #}
  <label for="max_postulaciones">M√°ximo de trabajadores a contratar:</label>
  <input type="number" name="max_postulaciones" value="5" min="1" max="100" required>

  {# Bot√≥n para enviar el formulario y publicar la oferta #}
  <button type="submit">‚úÖ Publicar Oferta</button>
</form>

{# Script para establecer el comportamiento del slider y la validaci√≥n de fecha #}
<script>
  document.addEventListener("DOMContentLoaded", () => {
    // Slider de pago
    const slider = document.getElementById("rango_pago");
    const output = document.getElementById("outputPago");
    output.value = '$' + parseInt(slider.value).toLocaleString('es-CO');

    // Fecha m√≠nima permitida es hoy
    const hoy = new Date();
    const yyyy = hoy.getFullYear();
    const mm = String(hoy.getMonth() + 1).padStart(2, '0');
    const dd = String(hoy.getDate()).padStart(2, '0');
    document.getElementById("fecha_limite").min = `${yyyy}-${mm}-${dd}`;
  });
</script>
{% endblock %}
